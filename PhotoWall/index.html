<!DOCTYPE html>
<html lang="es">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge"> 
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
        <meta name="HandheldFriendly" content="true" />
        <meta property="og:type" content="website">
		<meta property="og:UNICODE" content="Photo Wall">
		<meta name="theme-color" content="#000"> 
		<title>Photo Wall</title>
        <link rel='canonical' href='https://andruxand.github.io/PhotoWall/index.html'>
        <meta name='mobile-web-app-capable' content='yes'>
   		<meta name='apple-mobile-web-app-capable' content='yes'>
		<meta name="description" content="Moderno Photo Wall para capturar y compatir lo mejores momentos con todos" />
		<meta name="author" content="Unicode. Creating Innovation, Creation Experience." />
        <meta name='application-name' content='Photo Wall'>
    	<meta name='apple-mobile-web-app-status-bar-style' content='black'>
    	<meta name='apple-mobile-web-app-title' content='Photo Wall'>
        <link rel=icon sizes=192x192 href=favicon.ico>
    	<link rel=apple-touch-icon href=favicon.ico>
		<link rel="shortcut icon" href="favicon.ico">
        <meta name='msapplication-TileColor' content='#000'>
    	<meta name='theme-color' content='#000'>
        
		<link rel="stylesheet" type="text/css" href="css/normalize.css" />
        <link rel="stylesheet" type="text/css" href="css/demo.css" />
		<link rel="stylesheet" type="text/css" href="css/component.css" />
        <!-- Morph Button css -->
        <link rel="stylesheet" type="text/css" href="css/component_morph_button.css" />
        <!-- Camera Animate css -->
        <link rel="stylesheet" type="text/css" href="css/camera-animate.css" />
        <script>document.documentElement.className="js";var supportsCssVars=function(){var e,t=document.createElement("style");return t.innerHTML="root: { --tmp-var: bold; }",document.head.appendChild(t),e=!!(window.CSS&&window.CSS.supports&&window.CSS.supports("font-weight","var(--tmp-var)")),t.parentNode.removeChild(t),e};supportsCssVars()||alert("Please view this demo in a modern browser that supports CSS Variables.");</script>
		<script src="js/snap.svg-min.js"></script>
        <!-- Morph Button scripts -->
        <script src="js/modernizr.custom.js"></script>
		<!--[if IE]>
  		<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
        <!-- Take Photo GetUserMedia scripts -->
        <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
        <script src="js/face.js"></script>
        <script src="js/ccv.js"></script>
        <style type="text/css">
			display: block;display: block;* { margin:0; padding:0; } /* to remove the top and left whitespace */
			html, body { width:100%; height:100%;margin:0; } /* just to be sure these are full screen*/
			body {font-family: 'Helvetica'; overflow:hidden; }
			
			.none {
			  -webkit-filter: none;
			  filter: none;
			}
			.blur {
			  -webkit-filter: blur(3px);
			  filter: blur(3px);
			}
			.grayscale {
			  -webkit-filter: grayscale(1);
			  filter: grayscale(1);
			}
			.invert {
			  -webkit-filter: invert(1);
			  filter: invert(1);
			}
			.sepia {
			  -webkit-filter: sepia(1);
			  filter: sepia(1);
			}
			.hue-rotate {
				-webkit-filter: hue-rotate(45deg);
				filter: hue-rotate(180deg);
			}
			.brightness {
				-webkit-filter: brightness(50%);
				filter: brightness(50%);
			}
			.saturate {
				-webkit-filter: saturate(250%);
				filter: saturate(250%);
			}
			.contrast {
				-webkit-filter: contrast(1.5); /* 1.5 = 150% */ 
				filter: contrast(1.5); 
			}
		
			#localCanvas {
				bottom: 0;
				right: 0;
				min-width: 100%;
				min-height: 100%;
				width: auto;
				height: auto;
				top: 50%;
				left: 50%;
				transform: translateX(-50%) translateY(-50%);
				position: fixed;
				z-index: -1;
			}
		
			#localVideo {
				position: fixed;
				right: 0;
				bottom: 0;
				min-width: 100%;
				min-height: 100%;
				width: auto;
				height: auto;
				top: 50%;
				left: 50%;
				transform: translateX(-50%) translateY(-50%);
				z-index: -1;
			}
			
			.toolbar.left {
				justify-content: flex-start;
			}
			
			.center {
				justify-content: center;
			}
			
			.bott {
				margin-top: auto;
			}
			
			.toolbar {
				display: flex;
				flex-direction: row;
				justify-content: space-around;
				align-items: center;
				width: 100%;
				flex-shrink: 0;
			}
			
			.toolbar.right {
				justify-content: flex-end;
			}
			
			button svg {
				position: absolute;
				transform: translate(-50%, -50%);
				left: 50%;
				top: 50%;
			}
			
			a svg {
				position: absolute;
				transform: translate(-50%, -50%);
				left: 50%;
				top: 50%;
			}
			
			#page-2 svg {
				fill: currentColor;
				width: 26px;
			}
			
			button.dark, button.light {
				margin: 5px;
				border-radius: 50%;
				width: 54px;
				height: 54px;
				background-color: rgba(255, 255, 255, 0);
				overflow: hidden;
				border: none;
				color: white;
				position: relative;
			}
			
			a.dark:hover, a.dark:focus {
				background-color: rgba(255, 255, 255, 0.3);
				outline: 0;
			}
			a.dark, a.light {
				margin: 5px;
				border-radius: 50%;
				width: 54px;
				height: 54px;
				background-color: rgba(255, 255, 255, 0);
				overflow: hidden;
				border: none;
				color: white;
				position: relative;
				cursor:pointer;
			}
			
			#capture-button {
				color: black;
				margin: 10px;
				width: 80px;
				height: 80px;
				border-radius: 50%;
				background-color: rgba(255, 255, 255, 0.3);
				overflow: hidden;
				border: none;
				position: relative;
			}
			
			#capture-button:focus, #capture-button:hover {
				width: 90px;
				height: 90px;
				border: 5px #50E3C2 solid;
				margin: 5px;
				border-radius: 50%;
				outline: 0;
			}
			
			#capture-button-inner {
				width: 64px;
				height: 64px;
				border-radius: 50%;
				margin: 2px;
				background-color: white;
			}
			
			button.dark:hover, button.dark:focus {
				background-color: rgba(255, 255, 255, 0.3);
				outline: 0;
			}
			
			.view-element {
				display: flex;
				flex-direction: column;
				justify-content: flex-start;
				height: 100%;
				overflow: hidden;
			}
			
			#icon-flash-on {
				display: none;	
			}
			
			#icon-flash-off {
				display: none;	
			}
			
			#icon-flash-auto {
				display: none;	
			}
		
			button#snapshot {
			  margin: 0 10px 25px 0;
			  width: 110px;
			}
		
		 </style>
	</head>
	<body>
		<div id="pagewrap" class="pagewrap">
			<div class="container show" id="page-1">
				<div class="header">
                	<div class="slide__bg slide__bg--3"></div>
                    <div class="word">
                        <h2 class="word-animate word--3">Photo Wall</h2>
                        
                        <!-- camera animate -->
                        <div class="flat-anim animation">
                            <div class="eye"></div>
                            <div class="bottom"></div>
                        </div>
                        <!-- camera animate -->
                       
                        <!-- morph-button -->
                        <div class="morph-button morph-button-modal morph-button-modal-1 morph-button-fixed">
                            <button type="button">Términos &amp; Condiciones</button>
                            <div class="morph-content">
                                <div>
                                    <div class="content-style-text">
                                        <span class="icon" id="icon-close">Close the dialog</span>
                                        <h2>Terms &amp; Conditions</h2>
                                        <p>Pea horseradish azuki bean lettuce avocado asparagus okra. Kohlrabi radish okra azuki bean corn fava bean mustard tigernut juccama green bean celtuce collard greens avocado quandong <strong>fennel gumbo</strong> black-eyed pea. Grape silver beet watercress potato tigernut corn groundnut. Chickweed okra pea winter purslane coriander yarrow sweet pepper radish garlic brussels sprout groundnut summer purslane earthnut pea <strong>tomato spring onion</strong> azuki bean gourd.</p>
                                        <p><input id="terms" type="checkbox" /><label for="terms">I accept the terms &amp; conditions.</label></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                   		<!-- morph-button -->
                        
                        <div class="column center">
                            <p>To start the page loading animation, click the following link:</p>
                            <p><a class="pageload-link pageload" href="#page-2">Show Page Loader</a></p>
                        </div>
                    </div>
				</div>
			</div><!-- /container -->

			<!-- The new page dummy; this would be dynamically loaded content -->
			<div class="container" id="page-2">
				<div class="view-element" id="capture-view" style="">
                	<div class="toolbar">
                    	<a class="dark pageload" href="#page-1" id="capture-view-close" aria-label="Close" title="Close" tabindex="0">
                        	<svg viewBox="0 0 24 24">
                            	<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-close"></use>
                            </svg>
                        </a>
                            
                        <button class="dark" id="camera-choose-button" aria-label="Choose camera" title="Choose camera" tabindex="0">
                        	<svg id="icon-camera-rear" viewBox="0 0 24 24">
    	                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-camera-rear"></use>                            </svg>
                            <svg id="icon-camera-front" viewBox="0 0 24 24">
    	                    	<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-camera-front"></use>                      		</svg>    
                        </button>
                            
                        <button class="dark" id="capture-flash-button" aria-label="Toggle flash" title="Toggle flash" tabindex="0">
                        	<svg id="icon-flash-on" viewBox="0 0 24 24">
                            	<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-flash-on"></use>
                            </svg>
                            <svg id="icon-flash-off" viewBox="0 0 24 24">
                            	<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-flash-off"></use>
                            </svg>
                            <svg id="icon-flash-auto" viewBox="0 0 24 24">
                            	<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-flash-auto"></use>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="toolbar bott">
               		   <!-- espacio para más opcopnes de camara -->
                       <div id="mi-slider" class="mi-slider fadeOut">
                       		<ul id="listFilters">
                                <li><img src="img/test-filter.jpg" class="none"></li>
                                <li><img src="img/test-filter.jpg" class="brightness"></li>
                                <li><img src="img/test-filter.jpg" class="saturate"></li>
                                <li><img src="img/test-filter.jpg" class="contrast"></li>
                                <li><img src="img/test-filter.jpg" class="blur"></li>
                                <li><img src="img/test-filter.jpg" class="grayscale"></li>
                                <li><img src="img/test-filter.jpg" class="invert"></li>
                                <li><img src="img/test-filter.jpg" class="sepia"></li>
                                <li><img src="img/test-filter.jpg" class="hue-rotate"></li>
                            </ul>
                        </div>
                    </div>
                        
                    <div class="toolbar center">
                    
                    	<button class="dark hidden" id="camera-choose-button" aria-label="Choose camera" title="Choose camera" tabindex="0"> 	
                        </button>
                    
                		<button id="capture-button" aria-label="Take photo" title="Take photo" autofocus tabindex="0">
     	                	<div id="capture-button-inner">
        	                	<svg viewBox="0 0 24 24">
            	                	<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-photo-camera">
                                </use></svg>
                            </div>
                        </button>
                           
                        <button class="dark" id="photo-filter-button" aria-label="Photo Filter" title="Photo Filter" tabindex="0">
                        	<svg viewBox="0 0 24 24">
    	                    	<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-photo-filter"></use>                      		</svg>
                        </button>
                    </div>
                    
                    <video id="localVideo" autoplay muted></video>
                    <!-- <canvas id="localCanvas"></canvas> -->
                </div>
			</div><!-- /container -->		
		</div><!-- /pagewrap -->
        
        <div id="loader" class="pageload-overlay" data-opening="m -5,-5 0,70 90,0 0,-70 z m 5,35 c 0,0 15,20 40,0 25,-20 40,0 40,0 l 0,0 C 80,30 65,10 40,30 15,50 0,30 0,30 z">
			<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 80 60" preserveAspectRatio="none" >
				<path d="m -5,-5 0,70 90,0 0,-70 z m 5,5 c 0,0 7.9843788,0 40,0 35,0 40,0 40,0 l 0,60 c 0,0 -3.944487,0 -40,0 -30,0 -40,0 -40,0 z"/>
			</svg>
		</div><!-- /pageload-overlay -->
        
        <!-- loader page scripts -->
		<script src="js/classie.js"></script>
		<script src="js/svgLoader.js"></script>
        <!-- animate words scripts -->
        <script src="js/charming.min.js"></script>
		<script src="js/anime.min.js"></script>
		<script src="js/wordFx.js"></script>
        <!-- Morph Button scripts -->
        <script src="js/classie.js"></script>
		<script src="js/uiMorphingButton_fixed.js"></script>
		<script>
			(function() {
				
				/***************************************************/
				//             Pageloader Script                   //
				/***************************************************/
				
				var trigger;
				var pageWrap = document.getElementById( 'pagewrap' ),
					pages = [].slice.call( pageWrap.querySelectorAll( 'div.container' ) ),
					currentPage = 0,
					triggerLoading = [].slice.call( pageWrap.querySelectorAll( 'a.pageload' ) ),
					loader = new SVGLoader( document.getElementById( 'loader' ), { speedIn : 400, easingIn : mina.easeinout } );

				function init() {
					triggerLoading.forEach( function( trigger ) {
						trigger.addEventListener( 'click', function( ev ) {
							ev.preventDefault();
							loader.show();
							
							
							if (currentPage == 1){
								stopCamera();
							}	
							
							
							// after some time hide loader
							trigger = setTimeout( function() {
								loader.hide();

								classie.removeClass( pages[ currentPage ], 'show' );
								// update..
								currentPage = currentPage ? 0 : 1;
										 
								classie.addClass( pages[ currentPage ], 'show' );

							}, 2000 );
														
							
							setTimeout( function() {
								if (currentPage == 1){
									start();
								}	
							}, 2500 );
														
							
						} );
						clearTimeout(trigger);
					} );	
				}

				init();
				
				/***************************************************/
				//            FINAL Pageloader Script              //
				/***************************************************/
				
				/***************************************************/
				//             Animate Words Script                //
				/***************************************************/
				
				const effects = [
					// Effect
					{
						options: {
							shapeColors: ['#111']
						},
						hide: {
							shapesAnimationOpts: {
								duration: 200,
								delay: (t,i) => i*20,
								easing: 'easeOutExpo',
								translateX: t => t.dataset.tx,
								translateY: t => t.dataset.ty - anime.random(400,800),
								scale: t => t.dataset.s,
								rotate: 0,
								opacity: {
									value: 0, 
									duration: 200, 
									easing: 'linear'
								}
							}
						},
						show: {
							lettersAnimationOpts: {
								duration: 500,
								delay: (t,i) => i*60,
								easing: 'easeOutExpo',
								opacity: {
									value: [0,1], 
									duration: 50,
									delay: (t,i) => i*60,
									easing: 'linear'
								},
								translateY: (t,i) => i%2 ? [anime.random(-350,-300),0] : [anime.random(300,350),0]
							},
							shapesAnimationOpts: {
								duration: () => anime.random(1000,4000),
								delay: (t,i) => i*20,
								easing: [0.2,1,0.3,1],
								translateX: t => {
									const tx = anime.random(-200,200);
									t.dataset.tx = tx;
									return [0,tx];
								},
								translateY: t => {
									const ty = anime.random(-300,300);
									t.dataset.ty = ty;
									return [0,ty];
								},
								scale: t => {
									const s = randomBetween(0.2,0.6);
									t.dataset.s = s;
									return [s,s];
								},  
								rotate: () => anime.random(-90,90),
								opacity: {
									value: 0.6, 
									duration: 1000, 
									easing: 'linear'
								}
							}
						}
					},
				];

				var word_element = document.querySelector('.word--3');
				var current = 0;
				var words = new Word(word_element, effects[current].options);
				words.show(effects[current].show);
				
				/***************************************************/
				//             FINAL Animate Words Script          //
				/***************************************************/
				
				/***************************************************/
				//             Morph Button Script                 //
				/***************************************************/
				
				var docElem = window.document.documentElement, didScroll, scrollPosition;

				// trick to prevent scrolling when opening/closing button
				function noScrollFn() {
					window.scrollTo( scrollPosition ? scrollPosition.x : 0, scrollPosition ? scrollPosition.y : 0 );
				}

				function noScroll() {
					window.removeEventListener( 'scroll', scrollHandler );
					window.addEventListener( 'scroll', noScrollFn );
				}

				function scrollFn() {
					window.addEventListener( 'scroll', scrollHandler );
				}

				function canScroll() {
					window.removeEventListener( 'scroll', noScrollFn );
					scrollFn();
				}

				function scrollHandler() {
					if( !didScroll ) {
						didScroll = true;
						setTimeout( function() { scrollPage(); }, 60 );
					}
				};

				function scrollPage() {
					scrollPosition = { x : window.pageXOffset || docElem.scrollLeft, y : window.pageYOffset || docElem.scrollTop };
					didScroll = false;
				};

				scrollFn();

				var UIBtnn = new UIMorphingButton( document.querySelector( '.morph-button' ), {
					closeEl : '#icon-close',
					onBeforeOpen : function() {
						// don't allow to scroll
						noScroll();
					},
					onAfterOpen : function() {
						// can scroll again
						canScroll();
					},
					onBeforeClose : function() {
						// don't allow to scroll
						noScroll();
					},
					onAfterClose : function() {
						// can scroll again
						canScroll();
					}
				} );

				document.getElementById( 'terms' ).addEventListener( 'change', function() {
					UIBtnn.toggle();
				} );
				
				/***************************************************/
				//             FINAL Morph Button Script           //
				/***************************************************/
				
				/***************************************************/
				//             Take Photo GetUserMedia Script      //
				/***************************************************/	
				const SUPPORTS_MEDIA_DEVICES = 'mediaDevices' in navigator;

				if (SUPPORTS_MEDIA_DEVICES) {
				
					'use strict';
					
					var videoSelect = document.querySelector('button#camera-choose-button');
					var localVideo = document.getElementById("localVideo");
					var localCanvas = document.getElementById("localCanvas");
					var capturePhoto = document.getElementById("capture-button");
					var flashButton = document.querySelector('#capture-flash-button');
					var Slider = document.querySelector('#mi-slider');
					var listDevices = [];
					var currentDevice = 0;
					var track;
					var PCapabilities;
					var imageCaptureConfig;
					var imageCapture;
					var flashMode = ['flash', 'auto', 'off'];
					var currentFlashMode = 1; // default auto
					var cameraMode = ['icon-camera-rear', 'icon-camera-front'];
					var bateria;
					var batteryAlert = false;
					
					function showIconFlash(fillLightMode){
						
						switch(fillLightMode){
							case 'flash':
								currentFlashMode = 0;
								document.querySelector('svg#icon-flash-on').style.display = 'block';
								document.querySelector('svg#icon-flash-off').style.display = 'none';
								document.querySelector('svg#icon-flash-auto').style.display = 'none';
								break;
							case 'auto':
								currentFlashMode = 1;
								document.querySelector('svg#icon-flash-auto').style.display = 'block';
								document.querySelector('svg#icon-flash-off').style.display = 'none';
								document.querySelector('svg#icon-flash-on').style.display = 'none';
								break;
							case 'off':
								currentFlashMode = 2;
								document.querySelector('svg#icon-flash-off').style.display = 'block';
								document.querySelector('svg#icon-flash-auto').style.display = 'none';
								document.querySelector('svg#icon-flash-on').style.display = 'none';
								break;		
							
						}
								
					}
					
					function verifyBattery(){
						if (navigator.battery) {
							readBattery(navigator.battery);
						}else if (navigator.getBattery) {
							navigator.getBattery().then(readBattery);
						}	
					}
					
					function readBattery(b) {
						bateria = b || bateria;
					
						var percentage = parseFloat((bateria.level * 100).toFixed(2));
					
						if (!bateria.charging) {
							if ( (percentage <= 50) && ((currentFlashMode == 0) || (currentFlashMode == 1)) ) {
								currentFlashMode = 2;
								alert('nuevo modo: ' + currentFlashMode);
								if(!batteryAlert){
									batteryAlert = true;
						  			alert('Nivel de bateria bajo (' + percentage + '%). No se activará el flash.');
								}
							}
						}
					}
					
					function gotDevices(deviceInfos) {
						listDevices.splice(0,listDevices.length)
					  
						for (var i = 0; i !== deviceInfos.length; ++i) {
							var deviceInfo = deviceInfos[i];
						
							if (deviceInfo.kind === 'videoinput') {
								listDevices.push(deviceInfo.deviceId);	
								console.log('Some other kind of source/device: ', deviceInfo);
							}
						}
					}
					
					navigator.mediaDevices.enumerateDevices().then(gotDevices).catch(handleError);
	
					function gotStream(stream) {
						window.stream = stream; // make stream available to console
					  	localVideo.srcObject = stream;
					  
					  	document.querySelector('#camera-choose-button>svg').style.display = 'none';
					  	localVideo.style.display = 'block';
					  
					  	track = stream.getVideoTracks()[0];
						
						imageCapture = new ImageCapture(track)
						
						const Capabilities = track.getCapabilities();
						//const currentSettings = track.getSettings();
						//const currentPhotoSettings = imageCapture.getPhotoSettings();
						imageCapture.getPhotoCapabilities()
							.then(function(PhotoCapabilities){
								PCapabilities = (PhotoCapabilities.fillLightMode)?PhotoCapabilities.fillLightMode:null;
						});

						if ( (typeof PCapabilities === 'undefined') || (PCapabilities == null) ){
							flashButton.style.visibility = 'hidden';
							document.getElementById(cameraMode[currentDevice]).style.display = 'block';
						}else{
							showIconFlash(flashMode[currentFlashMode]);
							
							verifyBattery();
							
							flashButton.style.visibility = 'visible';
							
							document.getElementById(cameraMode[currentDevice]).style.display = 'block';

							flashButton.addEventListener('click', function(){
								if(currentFlashMode + 1 < 3){
									currentFlashMode = currentFlashMode + 1;	
								}else{
									currentFlashMode = 0;
								}
								
								showIconFlash(flashMode[currentFlashMode]);
								
								verifyBattery();
										
								imageCaptureConfig = {
									fillLightMode: flashMode[currentFlashMode], 
								};					
							});	
						}					
					
						track.applyConstraints({
							advanced :  [{ focusMode :  "continuous" }] 
						})
						.catch(err => console.log('error: ' + err));

					  	// Refresh button list in case labels have become available
					  	return navigator.mediaDevices.enumerateDevices();
					}
					
					function start() {
						stopCamera();
						
						var videoSource = listDevices[currentDevice]; //videoSelect.value; 
						var constraints = { 
							video: {
									facingMode: ['user', 'environment'], 
									deviceId: videoSource ? {exact: videoSource} : undefined
									}
						};
						
						localVideo.style.display = 'none';
						navigator.mediaDevices.getUserMedia(constraints)
						.then(gotStream).then(gotDevices).catch(handleError);	
					}
					
					function getDevice() {
						if (listDevices.length <= 1){
							alert('No hay más Cámaras disponibles para este dispositivo');	
						}else{
							if (currentDevice + 1 <= listDevices.length - 1){
								currentDevice = currentDevice + 1;
							}else{
								currentDevice = 0;  
							}
							
							start();
						}
					}
					
					function stopCamera() {
						if (window.stream) {
							window.stream.getTracks().forEach(track => track.stop());
							
							notAnimating(document.querySelector('div#mi-slider>ul'), null);
							//clearTimeout(timePoll);
							//clearTimeout(callTimePoll);
						}
					}
					
					videoSelect.addEventListener('click', function(){
						getDevice();
					});	
					
					capturePhoto.addEventListener('click', function(){
						takePhoto();
					});
					
					function takePhoto() {
						if(window.stream){
							imageCapture.takePhoto(imageCaptureConfig)
								.then(blob => {
									console.log('Photo taken: ' + blob.type + ', ' + blob.size + 'B');
						
									//const image = document.querySelector('img');
									//image.src = URL.createObjectURL(blob);
									alert(URL.createObjectURL(blob));
								})
								.catch(err => alert('takePhoto() failed: ', err));
						}
					}
					
					function handleError(error) {
						console.log('navigator.getUserMedia error: ', error);
					}
				
				}	
					
				/***************************************************/
				//       FINAL Take Photo GetUserMedia Script      //
				/***************************************************/
				
				/***************************************************/
				//       Photo Filters Animations Script           //
				/***************************************************/
				
				var button = document.querySelector('button#photo-filter-button');
				var isAnimating = false;
				
				function animating(container, buttonAction){
					Slider.className = Slider.className.replace('fadeOut', 'fadeIn');
						
					container.className += 'mi-moveFromRight';
					container.addEventListener('animationend', function(){
						isAnimating = true;	
						buttonAction.disabled = false;
					}, false);		
				}
				
				function notAnimating(container, buttonAction = null){
					Slider.className = Slider.className.replace('fadeIn', 'fadeOut');
						
					container.className = container.className.replace('mi-moveFromRight', 'mi-moveFromLeft');
					container.addEventListener('animationend', function(){
						container.className = container.className.replace('mi-moveFromLeft', '');
						isAnimating = false;
						if(buttonAction !== null)
							buttonAction.disabled = false;	
					}, false);	
				}
				
				button.addEventListener('click', function(){
					
					var buttonAction = this;
					var container = document.querySelector('div#mi-slider>ul');
					
					buttonAction.disabled = true;
					
					if (!isAnimating){	
						animating(container, buttonAction);	
					}else{
						notAnimating(container, buttonAction);			
					}
					
				});
				
				/***************************************************/
				//       FIN Photo Filters Animations Script       //
				/***************************************************/
				
				/***************************************************/
				//       Filters Selection Script                  //
				/***************************************************/
				
				var filters = document.querySelectorAll('ul#listFilters li img');
				var filtersParent = document.querySelectorAll('ul#listFilters li');

				for (filter of filters) {
					filter.addEventListener("click", function(evt){
						var filterClass = evt.target;
						
						for (filterParent of filtersParent) {
							filterParent.className = '';
						}
						
						console.log(filterClass.parentElement);
						localVideo.className = filterClass.className;
						filterClass.parentElement.className = 'current-filter';
					});
				}
				
				/***************************************************/
				//      FIN Filters Selection Script               //
				/***************************************************/
					
			})();
			
		</script>
        <svg class="hidden">
			<defs>
				<g id="svg-edit">
				  <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path>
				  <path d="M0 0h24v24H0z" fill="none"></path>
				</g>
				<g id="svg-arrow-back">
				  <path d="M0 0h24v24H0z" fill="none"></path>
				  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path>
				</g>
				<g id="svg-photo-camera">
				  <circle cx="12" cy="12" r="3.2"></circle>
				  <path d="M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"></path>
				  <path d="M0 0h24v24H0z" fill="none"></path>
				</g>
				<g id="svg-camera-rear">
				  <path d="M0 0h24v24H0z" fill="none"></path>
				  <path d="M10 20H5v2h5v2l3-3-3-3v2zm4 0v2h5v-2h-5zm3-20H7C5.9 0 5 .9 5 2v14c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V2c0-1.1-.9-2-2-2zm-5 6c-1.11 0-2-.9-2-2s.89-2 1.99-2 2 .9 2 2C14 5.1 13.1 6 12 6z"></path>
				</g>
				<g id="svg-camera-front">
				  <path d="M0 0h24v24H0z" fill="none"></path>
				  <path d="M10 20H5v2h5v2l3-3-3-3v2zm4 0v2h5v-2h-5zM12 8c1.1 0 2-.9 2-2s-.9-2-2-2-1.99.9-1.99 2S10.9 8 12 8zm5-8H7C5.9 0 5 .9 5 2v14c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V2c0-1.1-.9-2-2-2zM7 2h10v10.5c0-1.67-3.33-2.5-5-2.5s-5 .83-5 2.5V2z"></path>
				</g>
				<g id="svg-add-a-photo">
				  <defs>
					<path d="M24 24H0V0h24v24z" id="a"></path>
				  </defs>
				  <clipPath id="b">
					<use overflow="visible" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#a"></use>
				  </clipPath>
				  <path clip-path="url(#b)" d="M3 4V1h2v3h3v2H5v3H3V6H0V4h3zm3 6V7h3V4h7l1.83 2H21c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V10h3zm7 9c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-3.2-5c0 1.77 1.43 3.2 3.2 3.2s3.2-1.43 3.2-3.2-1.43-3.2-3.2-3.2-3.2 1.43-3.2 3.2z"></path>
				</g>
				<g id="svg-close">
				  <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
				  <path d="M0 0h24v24H0z" fill="none"></path>
				</g>
				<g id="svg-file-upload">
				  <path d="M0 0h24v24H0z" fill="none"></path>
				  <path d="M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"></path>
				</g>
				<g id="svg-blur-on">
				  <path d="M6 13c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0 4c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0-8c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm-3 .5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zM6 5c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm15 5.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zM14 7c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm0-3.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zm-11 10c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm7 7c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm0-17c.28 0 .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zM10 7c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm0 5.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm8 .5c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0 4c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0-8c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0-4c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm3 8.5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zM14 17c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0 3.5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm-4-12c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0 8.5c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm4-4.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-4c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z"></path>
				  <path d="M0 0h24v24H0z" fill="none"></path>
				</g>
				<g id="svg-wb-cloudy">
				  <path d="M0 0h24v24H0z" fill="none"></path>
				  <path d="M19.36 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.64-4.96z"></path>
				</g>
				<g id="svg-palette">
				  <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"></path>
				  <path d="M0 0h24v24H0z" fill="none"></path>
				</g>
				<g id="svg-exposure">
				  <path d="M0 0h24v24H0z" fill="none"></path>
				  <path d="M15 17v2h2v-2h2v-2h-2v-2h-2v2h-2v2h2zm5-15H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM5 5h6v2H5V5zm15 15H4L20 4v16z"></path>
				</g>
				<g id="svg-vignette">
				  <path d="M0 0h24v24H0V0z" fill="none"></path>
				  <path d="M21 3H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-9 15c-4.42 0-8-2.69-8-6s3.58-6 8-6 8 2.69 8 6-3.58 6-8 6z"></path>
				</g>
				<g id="svg-brightness-6">
				  <path d="M0 0h24v24H0z" fill="none"></path>
				  <path d="M20 15.31L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69zM12 18V6c3.31 0 6 2.69 6 6s-2.69 6-6 6z"></path>
				</g>
				<g id="svg-flip">
				  <path d="M0 0h24v24H0z" fill="none"></path>
				  <path d="M15 21h2v-2h-2v2zm4-12h2V7h-2v2zM3 5v14c0 1.1.9 2 2 2h4v-2H5V5h4V3H5c-1.1 0-2 .9-2 2zm16-2v2h2c0-1.1-.9-2-2-2zm-8 20h2V1h-2v22zm8-6h2v-2h-2v2zM15 5h2V3h-2v2zm4 8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2z"></path>
				</g>
				<g id="svg-photo-filter">
				  <path d="M0 0h24v24H0V0z" fill="none"></path>
				  <path d="M19.02 10v9H5V5h9V3H5.02c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-9h-2zM17 10l.94-2.06L20 7l-2.06-.94L17 4l-.94 2.06L14 7l2.06.94zm-3.75.75L12 8l-1.25 2.75L8 12l2.75 1.25L12 16l1.25-2.75L16 12z"></path>
				</g>
				<g id="svg-tune">
				  <path d="M0 0h24v24H0z" fill="none"></path>
				  <path d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"></path>
				</g>
				<g id="svg-check">
				  <path d="M0 0h24v24H0z" fill="none"></path>
				  <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"></path>
				</g>
				<g id="svg-flash-on">
				  <path d="M0 0h24v24H0z" fill="none"></path>
				  <path d="M7 2v11h3v9l7-12h-4l4-8z"></path>
				</g>
				<g id="svg-flash-off">
				  <path d="M0 0h24v24H0z" fill="none"></path>
				  <path d="M3.27 3L2 4.27l5 5V13h3v9l3.58-6.14L17.73 20 19 18.73 3.27 3zM17 10h-4l4-8H7v2.18l8.46 8.46L17 10z"></path>
				</g>
				<g id="svg-flash-auto">
				  <path d="M0 0h24v24H0z" fill="none"></path>
				  <path d="M3 2v12h3v9l7-12H9l4-9H3zm16 0h-2l-3.2 9h1.9l.7-2h3.2l.7 2h1.9L19 2zm-2.15 5.65L18 4l1.15 3.65h-2.3z"></path>
				</g>
    		</defs>
   		</svg>
	</body>
</html>